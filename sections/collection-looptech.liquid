{%- comment -%}
  LoopTech Collection Page - Rebuilt with Two-Tier Filtering

  Tier 1: Server-side Liquid filtering by product tags (brand-new/renewed)
  Tier 2: Client-side JavaScript filtering by SKU attributes (Brand, Capacity, Color)

  CRITICAL: All mode detection and filtering is INLINED because Liquid's
  render tag creates isolated variable scopes.
{%- endcomment -%}

{{ 'collection-looptech.css' | asset_url | stylesheet_tag }}
{{ 'looptech-collection-filter.js' | asset_url | script_tag }}

{%- comment -%}
  ============================================================================
  COLLECTION SETUP - Auto-detect from URL with naming convention for toggle
  ============================================================================
{%- endcomment -%}
{%- liquid
  # Use the current page's collection as Brand New
  assign brand_new_collection = collection

  # Derive Renewed collection from naming convention: {handle}-renewed
  assign renewed_handle = collection.handle | append: '-renewed'
  assign renewed_collection = collections[renewed_handle]

  # Fallback: If renewed collection doesn't exist, use the same collection
  if renewed_collection == blank or renewed_collection.products.size == 0
    assign renewed_collection = collection
    assign has_renewed_collection = false
  else
    assign has_renewed_collection = true
  endif

  # Display collection for header/title
  assign display_collection = brand_new_collection
-%}

{%- paginate display_collection.products by section.settings.products_per_page -%}

<div class="looptech-collection"
     data-section-id="{{ section.id }}"
     data-brand-new-collection="{{ brand_new_collection.handle }}"
     data-renewed-collection="{{ renewed_collection.handle }}"
     data-has-renewed="{{ has_renewed_collection }}"
     style="--padding-top: {{ section.settings.padding_top }}px; --padding-bottom: {{ section.settings.padding_bottom }}px; --grid-columns: {{ section.settings.grid_columns_desktop }};">

  {%- comment -%} Toggle Reminder Bar - Only show if renewed collection exists {%- endcomment -%}
  {%- if section.settings.show_toggle_reminder and has_renewed_collection -%}
    <div class="looptech-reminder-bar looptech-reminder-bar--brand-new" data-mode-reminder="brand-new">
      {{ section.settings.brand_new_reminder }}
    </div>
    <div class="looptech-reminder-bar looptech-reminder-bar--renewed" data-mode-reminder="renewed" style="display: none;">
      {{ section.settings.renewed_reminder }}
    </div>
  {%- endif -%}

  <div class="collection-looptech__container">

    {%- comment -%} Collection Header {%- endcomment -%}
    <header class="collection-looptech__header">
      <h1 class="collection-looptech__title">{{ display_collection.title }}</h1>
      {%- if display_collection.description != blank and section.settings.show_description -%}
        <div class="collection-looptech__description">{{ display_collection.description }}</div>
      {%- endif -%}
    </header>

    {%- comment -%} Offer Banner {%- endcomment -%}
    {%- if section.settings.show_offer_banner -%}
      {%- render 'looptech-offer-banner',
        offer_text: section.settings.offer_text,
        offer_icon: section.settings.offer_icon
      -%}
    {%- endif -%}

    {%- comment -%} Main Content: Sidebar + Products {%- endcomment -%}
    <div class="collection-looptech__main{% if section.settings.show_sidebar %} collection-looptech__main--with-filters{% endif %}">

      {%- comment -%}
        ========================================================================
        SIDEBAR: Tier 2 SKU-Based Filters (Populated by JavaScript)
        ========================================================================
      {%- endcomment -%}
      {%- if section.settings.show_sidebar -%}
        <aside class="looptech-sidebar" id="looptech-filters">
          <div class="looptech-sidebar__header">
            <h2 class="looptech-sidebar__title">Filters</h2>
            <button type="button" class="looptech-sidebar__clear" data-clear-all>
              Clear All
            </button>
          </div>

          {%- comment -%} Active Filters Display {%- endcomment -%}
          <div class="looptech-sidebar__active-filters" id="active-filters"></div>

          {%- comment -%} Price Range Filter {%- endcomment -%}
          {%- if section.settings.show_price_filter -%}
            <div class="looptech-filter-group" data-filter-group="price">
              <button class="looptech-filter-toggle" type="button" aria-expanded="true">
                <span>Price</span>
                <svg width="12" height="12" viewBox="0 0 12 12" fill="none">
                  <path d="M2 4L6 8L10 4" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
              </button>
              <div class="looptech-filter-content">
                <div class="looptech-price-range">
                  <input type="number" id="price-min" placeholder="Min" min="0" data-filter-price-min>
                  <span>-</span>
                  <input type="number" id="price-max" placeholder="Max" min="0" data-filter-price-max>
                </div>
              </div>
            </div>
          {%- endif -%}

          {%- comment -%} Brand Filter - Populated by JavaScript from SKU data {%- endcomment -%}
          {%- if section.settings.show_brand_filter -%}
            <div class="looptech-filter-group" data-filter-group="brand">
              <button class="looptech-filter-toggle" type="button" aria-expanded="true">
                <span>Brand</span>
                <svg width="12" height="12" viewBox="0 0 12 12" fill="none">
                  <path d="M2 4L6 8L10 4" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
              </button>
              <div class="looptech-filter-content" id="filter-brands">
                <p class="looptech-filter-loading">Loading brands...</p>
              </div>
            </div>
          {%- endif -%}

          {%- comment -%} Storage/Capacity Filter - Populated by JavaScript {%- endcomment -%}
          {%- if section.settings.show_capacity_filter -%}
            <div class="looptech-filter-group" data-filter-group="capacity">
              <button class="looptech-filter-toggle" type="button" aria-expanded="true">
                <span>Storage</span>
                <svg width="12" height="12" viewBox="0 0 12 12" fill="none">
                  <path d="M2 4L6 8L10 4" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
              </button>
              <div class="looptech-filter-content" id="filter-capacities">
                <p class="looptech-filter-loading">Loading options...</p>
              </div>
            </div>
          {%- endif -%}

          {%- comment -%} Color Filter - Populated by JavaScript {%- endcomment -%}
          {%- if section.settings.show_color_filter -%}
            <div class="looptech-filter-group" data-filter-group="color">
              <button class="looptech-filter-toggle" type="button" aria-expanded="true">
                <span>Color</span>
                <svg width="12" height="12" viewBox="0 0 12 12" fill="none">
                  <path d="M2 4L6 8L10 4" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
              </button>
              <div class="looptech-filter-content" id="filter-colors">
                <p class="looptech-filter-loading">Loading colors...</p>
              </div>
            </div>
          {%- endif -%}
        </aside>
      {%- endif -%}

      {%- comment -%}
        ========================================================================
        PRODUCTS AREA
        ========================================================================
      {%- endcomment -%}
      <div class="collection-looptech__products">

        {%- comment -%} Toolbar {%- endcomment -%}
        <div class="looptech-toolbar">
          <div class="looptech-toolbar__left">
            {%- if section.settings.show_sidebar -%}
              <button class="looptech-mobile-filter-btn" type="button" data-open-mobile-filters>
                <svg width="18" height="18" viewBox="0 0 18 18" fill="none">
                  <path d="M3 4.5H15M5.25 9H12.75M7.5 13.5H10.5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
                <span>Filters</span>
                <span class="looptech-filter-count" id="active-filter-count"></span>
              </button>
            {%- endif -%}
            {%- render 'looptech-view-toggle', default_view: section.settings.default_view -%}
          </div>
          <div class="looptech-toolbar__right">
            <div class="looptech-sort">
              <label for="looptech-sort-select">Sort by:</label>
              <select id="looptech-sort-select" data-sort-select>
                <option value="best-selling">Best Selling</option>
                <option value="price-asc">Price: Low to High</option>
                <option value="price-desc">Price: High to Low</option>
                <option value="title-asc">A-Z</option>
                <option value="title-desc">Z-A</option>
                <option value="created-desc">Newest</option>
              </select>
            </div>
            <span class="looptech-product-count" id="visible-count">
              {%- comment -%} Updated by JavaScript {%- endcomment -%}
            </span>
          </div>
        </div>

        {%- comment -%}
          ======================================================================
          BRAND NEW PRODUCTS GRID - Visible by default
          ======================================================================
        {%- endcomment -%}
        <div data-mode-content="brand-new">
          <div class="looptech-products-grid"
               data-view="{{ section.settings.default_view }}"
               data-mode-grid="brand-new"
               id="products-grid-brand-new">

            {%- assign visible_count_new = 0 -%}
            {%- assign promo_position = section.settings.promo_card_position -%}

            {%- for product in brand_new_collection.products -%}
              {%- assign visible_count_new = visible_count_new | plus: 1 -%}

              {%- comment -%} Parse SKU for data attributes {%- endcomment -%}
              {%- liquid
                assign sku = product.selected_or_first_available_variant.sku | default: ''
                assign sku_parts = sku | split: '-'
                assign parts_count = sku_parts | size

                if parts_count >= 6
                  assign sku_brand = sku_parts[0]
                  assign sku_model = sku_parts[1]
                  assign sku_capacity = sku_parts[2]
                  assign sku_condition = sku_parts[3]
                  assign sku_color = sku_parts[4]
                else
                  assign sku_brand = ''
                  assign sku_model = ''
                  assign sku_capacity = ''
                  assign sku_condition = ''
                  assign sku_color = ''
                endif
              -%}

              {%- comment -%} Insert promo card at configured position {%- endcomment -%}
              {%- if section.settings.show_promo_card and visible_count_new == promo_position -%}
                {%- if section.settings.default_view == 'tiles' -%}
                  {%- render 'looptech-promo-card', style: 'tile', current_mode: 'brand-new' -%}
                {%- else -%}
                  {%- render 'looptech-promo-card', style: 'grid', current_mode: 'brand-new' -%}
                {%- endif -%}
              {%- endif -%}

              <article class="looptech-product-item"
                       data-product-id="{{ product.id }}"
                       data-sku="{{ sku }}"
                       data-brand="{{ sku_brand }}"
                       data-model="{{ sku_model }}"
                       data-capacity="{{ sku_capacity }}"
                       data-color="{{ sku_color }}"
                       data-condition="{{ sku_condition }}"
                       data-price="{{ product.price }}"
                       data-mode="brand-new"
                       data-title="{{ product.title | escape }}"
                       data-created="{{ product.created_at | date: '%s' }}">

                {%- comment -%} Render both card types - CSS controls visibility {%- endcomment -%}
                <div class="looptech-card-view looptech-card-view--tiles">
                  {%- render 'looptech-product-card-tile', product: product -%}
                </div>
                <div class="looptech-card-view looptech-card-view--grid">
                  {%- render 'looptech-product-card-grid', product: product -%}
                </div>
              </article>
            {%- endfor -%}

            {%- if visible_count_new == 0 -%}
              <div class="looptech-empty-state">
                <div class="looptech-empty-state__content">
                  <h3>No products found</h3>
                  <p>This collection is empty.</p>
                </div>
              </div>
            {%- endif -%}
          </div>
        </div>

        {%- comment -%}
          ======================================================================
          RENEWED PRODUCTS GRID - Hidden by default
          ======================================================================
        {%- endcomment -%}
        <div data-mode-content="renewed" style="display: none;">
          <div class="looptech-products-grid"
               data-view="{{ section.settings.default_view }}"
               data-mode-grid="renewed"
               id="products-grid-renewed">

            {%- assign visible_count_renewed = 0 -%}

            {%- for product in renewed_collection.products -%}
              {%- assign visible_count_renewed = visible_count_renewed | plus: 1 -%}

              {%- comment -%} Parse SKU for data attributes {%- endcomment -%}
              {%- liquid
                assign sku = product.selected_or_first_available_variant.sku | default: ''
                assign sku_parts = sku | split: '-'
                assign parts_count = sku_parts | size

                if parts_count >= 6
                  assign sku_brand = sku_parts[0]
                  assign sku_model = sku_parts[1]
                  assign sku_capacity = sku_parts[2]
                  assign sku_condition = sku_parts[3]
                  assign sku_color = sku_parts[4]
                else
                  assign sku_brand = ''
                  assign sku_model = ''
                  assign sku_capacity = ''
                  assign sku_condition = ''
                  assign sku_color = ''
                endif
              -%}

              {%- comment -%} Insert promo card at configured position {%- endcomment -%}
              {%- if section.settings.show_promo_card and visible_count_renewed == promo_position -%}
                {%- if section.settings.default_view == 'tiles' -%}
                  {%- render 'looptech-promo-card', style: 'tile', current_mode: 'renewed' -%}
                {%- else -%}
                  {%- render 'looptech-promo-card', style: 'grid', current_mode: 'renewed' -%}
                {%- endif -%}
              {%- endif -%}

              <article class="looptech-product-item"
                       data-product-id="{{ product.id }}"
                       data-sku="{{ sku }}"
                       data-brand="{{ sku_brand }}"
                       data-model="{{ sku_model }}"
                       data-capacity="{{ sku_capacity }}"
                       data-color="{{ sku_color }}"
                       data-condition="{{ sku_condition }}"
                       data-price="{{ product.price }}"
                       data-mode="renewed"
                       data-title="{{ product.title | escape }}"
                       data-created="{{ product.created_at | date: '%s' }}">

                {%- comment -%} Render both card types - CSS controls visibility {%- endcomment -%}
                <div class="looptech-card-view looptech-card-view--tiles">
                  {%- render 'looptech-product-card-tile', product: product -%}
                </div>
                <div class="looptech-card-view looptech-card-view--grid">
                  {%- render 'looptech-product-card-grid', product: product -%}
                </div>
              </article>
            {%- endfor -%}

            {%- if visible_count_renewed == 0 -%}
              <div class="looptech-empty-state">
                <div class="looptech-empty-state__content">
                  {%- if has_renewed_collection == false -%}
                    <h3>No Renewed collection found</h3>
                    <p>Create a collection named "{{ renewed_handle }}" to enable the toggle.</p>
                  {%- else -%}
                    <h3>No Renewed products available</h3>
                    <p>Check back soon for renewed options.</p>
                  {%- endif -%}
                </div>
              </div>
            {%- endif -%}
          </div>
        </div>

        {%- comment -%} Pagination {%- endcomment -%}
        {%- if paginate.pages > 1 -%}
          <nav class="collection-looptech__pagination" aria-label="Pagination">
            <ul class="collection-looptech__pagination-list">
              {%- if paginate.previous -%}
                <li>
                  <a href="{{ paginate.previous.url }}" class="collection-looptech__pagination-link collection-looptech__pagination-link--prev" aria-label="Previous page">
                    <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
                      <path d="M10 12L6 8L10 4" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                  </a>
                </li>
              {%- endif -%}

              {%- for part in paginate.parts -%}
                <li>
                  {%- if part.is_link -%}
                    <a href="{{ part.url }}" class="collection-looptech__pagination-link">{{ part.title }}</a>
                  {%- else -%}
                    {%- if part.title == paginate.current_page -%}
                      <span class="collection-looptech__pagination-link collection-looptech__pagination-link--current" aria-current="page">{{ part.title }}</span>
                    {%- else -%}
                      <span class="collection-looptech__pagination-link">{{ part.title }}</span>
                    {%- endif -%}
                  {%- endif -%}
                </li>
              {%- endfor -%}

              {%- if paginate.next -%}
                <li>
                  <a href="{{ paginate.next.url }}" class="collection-looptech__pagination-link collection-looptech__pagination-link--next" aria-label="Next page">
                    <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
                      <path d="M6 12L10 8L6 4" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                  </a>
                </li>
              {%- endif -%}
            </ul>
          </nav>
        {%- endif -%}

      </div>
    </div>
  </div>

  {%- comment -%} Mobile Filter Drawer {%- endcomment -%}
  {%- if section.settings.show_sidebar -%}
    <div class="looptech-filter-drawer-overlay" data-filter-overlay></div>
    <div class="looptech-filter-drawer" data-filter-drawer>
      <div class="looptech-filter-drawer__header">
        <h2 class="looptech-filter-drawer__title">Filters</h2>
        <button class="looptech-filter-drawer__close" type="button" data-close-mobile-filters aria-label="Close filters">
          <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
            <path d="M15 5L5 15M5 5L15 15" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
        </button>
      </div>
      <div class="looptech-filter-drawer__content">
        {%- comment -%} Mobile filters - clone of sidebar content via JavaScript {%- endcomment -%}
        <div id="mobile-filters-content"></div>
      </div>
      <div class="looptech-filter-drawer__footer">
        <button type="button" class="looptech-filter-drawer__clear" data-clear-all>Clear</button>
        <button type="button" class="looptech-filter-drawer__apply" data-close-mobile-filters>Apply</button>
      </div>
    </div>
  {%- endif -%}

</div>

<script>
  (function() {
    'use strict';

    const VIEW_STORAGE_KEY = 'looptech_collection_view';
    const VALID_VIEWS = ['tiles', 'grid'];
    const SECTION_ID = '{{ section.id }}';
    let section = null;

    // ========================================
    // MODE SWITCHING FUNCTIONALITY
    // ========================================
    function getCurrentMode() {
      // Use global API if available, otherwise read localStorage directly
      if (window.LooptechModeToggle && typeof window.LooptechModeToggle.getMode === 'function') {
        return window.LooptechModeToggle.getMode();
      }
      try {
        const mode = localStorage.getItem('looptech-mode');
        return (mode === 'renewed') ? 'renewed' : 'brand-new';
      } catch (e) {
        return 'brand-new';
      }
    }

    function updateModeVisibility() {
      if (!section) {
        section = document.querySelector('[data-section-id="' + SECTION_ID + '"]');
      }
      if (!section) return;

      const mode = getCurrentMode();
      const hasRenewed = section.dataset.hasRenewed === 'true';

      // If no renewed collection exists, always show brand-new
      const effectiveMode = (mode === 'renewed' && !hasRenewed) ? 'brand-new' : mode;

      // Update reminder bars
      const brandNewReminder = section.querySelector('[data-mode-reminder="brand-new"]');
      const renewedReminder = section.querySelector('[data-mode-reminder="renewed"]');
      if (brandNewReminder) {
        brandNewReminder.style.display = effectiveMode === 'brand-new' ? 'block' : 'none';
      }
      if (renewedReminder) {
        renewedReminder.style.display = effectiveMode === 'renewed' ? 'block' : 'none';
      }

      // Update product grids
      const brandNewContent = section.querySelector('[data-mode-content="brand-new"]');
      const renewedContent = section.querySelector('[data-mode-content="renewed"]');
      if (brandNewContent) {
        brandNewContent.style.display = effectiveMode === 'brand-new' ? 'block' : 'none';
      }
      if (renewedContent) {
        renewedContent.style.display = effectiveMode === 'renewed' ? 'block' : 'none';
      }

      // Update product count
      updateProductCount(effectiveMode);

      console.log('[LoopTech Collection] Mode updated to:', effectiveMode);
    }

    function updateProductCount(mode) {
      const countEl = document.getElementById('visible-count');
      if (!countEl) return;

      const gridId = mode === 'renewed' ? 'products-grid-renewed' : 'products-grid-brand-new';
      const grid = document.getElementById(gridId);
      if (grid) {
        const visibleItems = grid.querySelectorAll('.looptech-product-item:not([style*="display: none"])');
        countEl.textContent = visibleItems.length + ' products';
      }
    }

    // ========================================
    // INITIALIZATION
    // ========================================
    function init() {
      section = document.querySelector('[data-section-id="' + SECTION_ID + '"]');

      // Initial mode update
      updateModeVisibility();

      // Listen for mode changes from toggle
      window.addEventListener('looptech-mode-change', updateModeVisibility);

      // ========================================
      // VIEW TOGGLE FUNCTIONALITY
      // ========================================
      const viewButtons = document.querySelectorAll('[data-view-btn]');

      function applyView(view) {
        viewButtons.forEach(function(b) {
          var isActive = b.dataset.viewBtn === view;
          b.classList.toggle('looptech-view-toggle__btn--active', isActive);
        });

        // Apply to both grids
        var grids = section.querySelectorAll('.looptech-products-grid');
        grids.forEach(function(grid) {
          grid.dataset.view = view;
        });
      }

      // Load saved view preference
      try {
        var savedView = localStorage.getItem(VIEW_STORAGE_KEY);
        if (savedView && VALID_VIEWS.indexOf(savedView) !== -1) {
          applyView(savedView);
        }
      } catch(e) {}

      // Handle view toggle clicks
      viewButtons.forEach(function(btn) {
        btn.addEventListener('click', function() {
          var view = this.dataset.viewBtn;
          applyView(view);
          try {
            localStorage.setItem(VIEW_STORAGE_KEY, view);
          } catch(e) {}
        });
      });

      // ========================================
      // MOBILE FILTERS
      // ========================================
      var sidebarFilters = document.getElementById('looptech-filters');
      var mobileFiltersContent = document.getElementById('mobile-filters-content');
      if (sidebarFilters && mobileFiltersContent) {
        var filterGroups = sidebarFilters.querySelectorAll('.looptech-filter-group');
        filterGroups.forEach(function(group) {
          mobileFiltersContent.appendChild(group.cloneNode(true));
        });
      }
    }

    // Run on DOM ready
    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', init);
    } else {
      init();
    }
  })();
</script>

{%- endpaginate -%}

{% schema %}
{
  "name": "LoopTech Collection",
  "tag": "section",
  "class": "looptech-collection-section",
  "settings": [
    {
      "type": "paragraph",
      "content": "This section automatically displays products from the current collection page. For toggle support, create a parallel collection with '-renewed' suffix (e.g., 'iphones' and 'iphones-renewed')."
    },
    {
      "type": "checkbox",
      "id": "show_toggle_reminder",
      "label": "Show Toggle Reminder Bar",
      "default": true
    },
    {
      "type": "text",
      "id": "brand_new_reminder",
      "label": "Brand New Reminder Text",
      "default": "You're viewing Brand New products. Switch to Renewed for savings."
    },
    {
      "type": "text",
      "id": "renewed_reminder",
      "label": "Renewed Reminder Text",
      "default": "You're viewing Renewed products. Switch to Brand New for latest."
    },
    {
      "type": "header",
      "content": "Sidebar Filters (Tier 2)"
    },
    {
      "type": "checkbox",
      "id": "show_sidebar",
      "label": "Show Filter Sidebar",
      "default": true,
      "info": "SKU-based filters: Brand, Storage, Color"
    },
    {
      "type": "checkbox",
      "id": "show_price_filter",
      "label": "Show Price Range Filter",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "show_brand_filter",
      "label": "Show Brand Filter",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "show_capacity_filter",
      "label": "Show Storage/Capacity Filter",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "show_color_filter",
      "label": "Show Color Filter",
      "default": true
    },
    {
      "type": "header",
      "content": "Layout Settings"
    },
    {
      "type": "select",
      "id": "default_view",
      "label": "Default View",
      "options": [
        { "value": "tiles", "label": "Long Tiles (List)" },
        { "value": "grid", "label": "Grid" }
      ],
      "default": "tiles"
    },
    {
      "type": "range",
      "id": "products_per_page",
      "min": 8,
      "max": 48,
      "step": 4,
      "label": "Products Per Page",
      "default": 24
    },
    {
      "type": "range",
      "id": "grid_columns_desktop",
      "min": 2,
      "max": 4,
      "step": 1,
      "label": "Grid Columns (Desktop)",
      "default": 3,
      "info": "Number of columns in grid view (recommended: 3)"
    },
    {
      "type": "checkbox",
      "id": "show_description",
      "label": "Show Collection Description",
      "default": false
    },
    {
      "type": "header",
      "content": "Offer Banner"
    },
    {
      "type": "checkbox",
      "id": "show_offer_banner",
      "label": "Show Offer Banner",
      "default": true
    },
    {
      "type": "text",
      "id": "offer_text",
      "label": "Offer Text",
      "default": "10% Off Any Laptop or Tablet with Any Smartphone Purchase"
    },
    {
      "type": "text",
      "id": "offer_icon",
      "label": "Offer Icon (emoji)"
    },
    {
      "type": "header",
      "content": "Promo Card"
    },
    {
      "type": "checkbox",
      "id": "show_promo_card",
      "label": "Show Promo Card",
      "default": true,
      "info": "Displays a promotional card to switch modes"
    },
    {
      "type": "range",
      "id": "promo_card_position",
      "min": 1,
      "max": 12,
      "step": 1,
      "label": "Promo Card Position",
      "default": 3,
      "info": "Show after X products"
    },
    {
      "type": "header",
      "content": "Spacing"
    },
    {
      "type": "range",
      "id": "padding_top",
      "min": 0,
      "max": 100,
      "step": 4,
      "unit": "px",
      "label": "Padding Top",
      "default": 24
    },
    {
      "type": "range",
      "id": "padding_bottom",
      "min": 0,
      "max": 100,
      "step": 4,
      "unit": "px",
      "label": "Padding Bottom",
      "default": 24
    }
  ],
  "presets": [
    {
      "name": "LoopTech Collection"
    }
  ],
  "templates": ["collection"]
}
{% endschema %}
